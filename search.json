[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Group13 Reproducible Study",
    "section": "",
    "text": "Preface\nThis is a Quarto book.\nTo learn more about Quarto books visit https://quarto.org/docs/books.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "one.html",
    "href": "one.html",
    "title": "1  （一）",
    "section": "",
    "text": "# 加载必要的包\nlibrary(maps)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(here)\n\nhere() starts at /Users/gaoch/GitHub/D2RS-2025spring/datareproduction13\n\n# 构建相对路径\ndata_path &lt;- xfun::magic_path(\"map-full.txt\")\n\n# 检查文件是否存在\nif (!file.exists(data_path)) {\n  stop(paste(\"错误：文件不存在 -\", data_path))\n}\n\n# 读取数据\ndata &lt;- read.delim(data_path, header = TRUE)\n\n# 设置因子水平\ndata$habitat &lt;- factor(data$habitat, levels = c(\n  'Animal husbandry',\n  'Food',\n  'Human',\n  'Soil',\n  'Surface water',\n  'Aquatic organism',\n  'Sediment',\n  'Wild animal',\n  'Plant',\n  'Insect',\n  'Seawater'\n))\nworld &lt;- map_data(\"world\")\n\nfinal_map &lt;- ggplot() +\n  geom_polygon(data=world,aes(x=long,y=lat,group=group),\n               fill=\"#dedede\")+\n  geom_point(data=data,aes(x=longitude,y=latitude,fill=habitat,size=number),shape=21,alpha=0.6)+\n  scale_fill_manual(values = c('#BDB9DA',\"#80B0D2\",'#8DD2C6','#FA8071',\"#B3DE69\",\n                               \"#D9D9D9\",\"#CCEBC5\",\"#FBCDE4\",\"#FCB461\",\"#BB80BC\",\"#FFEC6D\"))+\n  scale_y_continuous(expand = expansion(mult=c(0,0)))+\n  scale_x_continuous(expand = expansion(add=c(0,0)))+\n  theme_void()\n\nprint(final_map)\n\n\n\n\n\n\n\n\n\n# 保存地图\nggsave(here(\"figures\", \"lab_sample_map.png\"), \n       plot = final_map, \n       width = 10, height = 8, dpi = 300)\n\n\n# 输出摘要统计\nhabitat_counts &lt;- table(data$habitat)\nprint(\"栖息地样本数量分布:\")\n\n[1] \"栖息地样本数量分布:\"\n\nprint(habitat_counts)\n\n\nAnimal husbandry             Food            Human             Soil \n              53               25               69               59 \n   Surface water Aquatic organism         Sediment      Wild animal \n              63               44               76               52 \n           Plant           Insect         Seawater \n              56               53               93 \n\n# 输出统计结果到文件\ncat(\"实验室样本统计摘要\\n====================\\n\\n\")\n\n实验室样本统计摘要\n====================\n\ncat(\"总样本数:\", nrow(data), \"\\n\\n\")\n\n总样本数: 643 \n\ncat(\"栖息地分布:\\n\")\n\n栖息地分布:\n\nprint(habitat_counts)\n\n\nAnimal husbandry             Food            Human             Soil \n              53               25               69               59 \n   Surface water Aquatic organism         Sediment      Wild animal \n              63               44               76               52 \n           Plant           Insect         Seawater \n              56               53               93 \n\ncat(\"\\n经纬度范围:\\n\")\n\n\n经纬度范围:\n\nprint(summary(data[, c(\"longitude\", \"latitude\")]))\n\n   longitude          latitude      \n Min.   :-177.92   Min.   :-82.450  \n 1st Qu.: -71.29   1st Qu.:  8.185  \n Median :  13.19   Median : 31.430  \n Mean   :  15.32   Mean   : 22.014  \n 3rd Qu.: 103.28   3rd Qu.: 42.665  \n Max.   : 179.52   Max.   : 84.350  \n\n\n\n# 设置因子水平\ndata$habitat &lt;- factor(data$habitat, levels = c(\n  'Animal husbandry',\n  'Food',\n  'Human',\n  'Soil',\n  'Surface water',\n  'Aquatic organism',\n  'Sediment',\n  'Wild animal',\n  'Plant',\n  'Insect',\n  'Seawater'\n))\n\n# 定义生境颜色\nhabitat_colors &lt;- c(\n  'Animal husbandry' = '#E41A1C',\n  'Food' = '#377EB8',\n  'Human' = '#4DAF4A',\n  'Soil' = '#984EA3',\n  'Surface water' = '#FF7F00',\n  'Aquatic organism' = '#FFFF33',\n  'Sediment' = '#A65628',\n  'Wild animal' = '#F781BF',\n  'Plant' = '#999999',\n  'Insect' = '#E6AB02',\n  'Seawater' = '#66C2A5'\n)\n\n\n# 正确显示中文\nlibrary(showtext)\n\nLoading required package: sysfonts\n\n\nLoading required package: showtextdb\n\nshowtext_auto()\n\n# 创建改进的地图\nmap_plot &lt;- ggplot() +\n  annotate(\"rect\", xmin = -180, xmax = 180, ymin = -90, ymax = 90, \n           fill = \"#cceeff\", color = NA) +\n  geom_polygon(data = world, aes(x = long, y = lat, group = group),\n               fill = \"#dedede\", color = \"gray60\", size = 0.2) +\n  geom_point(data = data, aes(x = longitude, y = latitude, fill = habitat, size = number),\n             shape = 21, alpha = 0.7, stroke = 0.5, color = \"white\") +\n  scale_fill_manual(values = habitat_colors, name = \"生境类型\") +\n  scale_size_continuous(range = c(2, 8), name = \"数量\") +\n  scale_y_continuous(\n    limits = c(-90, 90), \n    expand = expansion(mult = c(0, 0)),\n    name = \"纬度\"\n  ) +\n  scale_x_continuous(\n    limits = c(-180, 180), \n    expand = expansion(mult = c(0, 0)),\n    name = \"经度\"\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid = element_line(color = \"gray90\", size = 0.2),\n    axis.title = element_text(size = 12, face = \"bold\"),\n    axis.text = element_text(size = 10, color = \"gray30\"),\n    legend.title = element_text(size = 11, face = \"bold\"),\n    legend.text = element_text(size = 9),\n    legend.position = \"bottom\",\n    legend.box = \"horizontal\",\n    legend.key.size = unit(0.8, \"lines\"),\n    plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),\n    plot.subtitle = element_text(size = 10, hjust = 0.5, color = \"gray40\"),\n    plot.margin = margin(10, 10, 10, 10)\n  ) +\n  labs(\n    title = \"全球生境分布与数量可视化\",\n    subtitle = \"数据来源: map-full.txt\"\n  )\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\nWarning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n\nprint(map_plot)\n\n\n\n\n\n\n\n\n\n# 输出摘要统计\nhabitat_counts &lt;- table(data$habitat)\nprint(\"栖息地样本数量分布:\")\n\n[1] \"栖息地样本数量分布:\"\n\nprint(habitat_counts)\n\n\nAnimal husbandry             Food            Human             Soil \n              53               25               69               59 \n   Surface water Aquatic organism         Sediment      Wild animal \n              63               44               76               52 \n           Plant           Insect         Seawater \n              56               53               93 \n\n# 输出统计结果到文件\ncat(\"实验室样本统计摘要\\n====================\\n\\n\")\n\n实验室样本统计摘要\n====================\n\ncat(\"总样本数:\", nrow(data), \"\\n\\n\")\n\n总样本数: 643 \n\ncat(\"栖息地分布:\\n\")\n\n栖息地分布:\n\nprint(habitat_counts)\n\n\nAnimal husbandry             Food            Human             Soil \n              53               25               69               59 \n   Surface water Aquatic organism         Sediment      Wild animal \n              63               44               76               52 \n           Plant           Insect         Seawater \n              56               53               93 \n\ncat(\"\\n经纬度范围:\\n\")\n\n\n经纬度范围:\n\nprint(summary(data[, c(\"longitude\", \"latitude\")]))\n\n   longitude          latitude      \n Min.   :-177.92   Min.   :-82.450  \n 1st Qu.: -71.29   1st Qu.:  8.185  \n Median :  13.19   Median : 31.430  \n Mean   :  15.32   Mean   : 22.014  \n 3rd Qu.: 103.28   3rd Qu.: 42.665  \n Max.   : 179.52   Max.   : 84.350",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>（一）</span>"
    ]
  },
  {
    "objectID": "two.html",
    "href": "two.html",
    "title": "2  （二）",
    "section": "",
    "text": "文献：Targeted depletion of TRBV9+ T cells as immunotherapy in a patient with ankylosing spondylitis，Extended Data Fig. 1 TRBV9+ T cell depletion in monkeys.\n需提前安装，install.packages(\"ggplot2\")\n\nlibrary(ggplot2)\nmydata &lt;- data.frame(sex = c(rep(\"female\", 19), rep(\"male\", 20)),\n  dose = c(rep(\"control\", 5), rep(\"3 mg/kg\", 4), rep(\"10 mg/kg\", 5), rep(\"30 mg/kg\", 5),\n           rep(\"control\", 5), rep(\"3 mg/kg\", 5), rep(\"10 mg/kg\", 4), rep(\"30 mg/kg\", 6)),\n  values = c(113.5, 113.5, 82.7, 120.9, 106.5, 11, 5.8, 23.4, 10.3, 5.1, 16,\n             10.3, 7.5, 8.5, 5.8, 7.1, 12.5, 16, 15, 113.5, 93.9, 100, 88.1,\n             93.9, 12.5, 11, 5.1, 4.3, 9.1, 8.5, 13.3, 11.7, 5.1, 8.5, 11,\n             8, 22, 23.4, 5.8))\n\nhead(mydata);tail(mydata)\n\n     sex    dose values\n1 female control  113.5\n2 female control  113.5\n3 female control   82.7\n4 female control  120.9\n5 female control  106.5\n6 female 3 mg/kg   11.0\n\n\n    sex     dose values\n34 male 30 mg/kg    8.5\n35 male 30 mg/kg   11.0\n36 male 30 mg/kg    8.0\n37 male 30 mg/kg   22.0\n38 male 30 mg/kg   23.4\n39 male 30 mg/kg    5.8\n\nggplot(mydata, aes(x = dose, y = values, colour = sex, fill = sex)) +\n  geom_boxplot(outlier.shape = NA, linewidth = 0.4) +\n  geom_point(size = 1, position = position_jitterdodge(0.11)) +\n  scale_x_discrete(limits = c(\"control\", \"3 mg/kg\", \"10 mg/kg\", \"30 mg/kg\")) +\n  scale_y_continuous(limits = c(0, 150), breaks = seq(0, 150, 25)) +\n  scale_fill_manual(values = alpha(c(\"#E19841\", \"#50A87C\"), 0.3)) +\n  scale_colour_manual(values = c(\"#E19841\", \"#50A87C\")) +\n  annotate(\"segment\", x = 1, xend = 2, y = 149, yend = 149) +\n  annotate(\"segment\", x = 1, xend = 3, y = 138.5, yend = 138.5) +\n  annotate(\"segment\", x = 1, xend = 4, y = 127, yend = 127) +\n  annotate(\"text\", x = 1.5, y = 150, size = 5, label = \"***\") +\n  annotate(\"text\", x = 2, y = 139.5, size = 5, label = \"***\") +\n  annotate(\"text\", x = 2.5, y = 128, size = 5, label = \"***\") +\n  theme_bw() +\n  theme(legend.position = c(0.9, 0.65),\n        axis.text = element_text(size = 10),\n        axis.title = element_text(size = 12),\n        plot.margin = margin(20, 20, 20, 20)) +\n  labs(x = \"dosage\",\n       y = \"Normalized TRBV9 \\n proportion, RT-PCR\",\n       fill = \"\",\n       colour = \"\")\n\nWarning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n3.5.0.\nℹ Please use the `legend.position.inside` argument of `theme()` instead.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>（二）</span>"
    ]
  }
]